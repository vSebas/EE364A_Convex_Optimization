\section*{A16.11 Control with various objectives}

\begin{figure}[H]
\centering
\includegraphics[width=\textwidth]{img/a16_11_controls.png}
\caption{Optimal control inputs for each objective. Blue and red show the two components $u_1, u_2$; black dashed shows $\|u_t\|_2$.}
\end{figure}

\begin{itemize}
\item \textbf{(a) Sum of squares:} As seen in subplot (a), the control is smooth and spreads effort across all time steps. The quadratic penalty discourages large deviations.

\item \textbf{(b) Sum of 2-norms:} As seen in subplot (b), many time steps have $u_t \approx 0$ (group sparsity). The control acts in bursts at the beginning and end.
\item \textbf{(c) Max of 2-norms:} As seen in subplot (c), the control is spread evenly with $\|u_t\|_2 \approx 0.11$ for most $t$.

\item \textbf{(d) Sum of 1-norms:} As seen in subplot (d), many individual components are zero (element-wise sparsity). The control uses one actuator at a time.
\end{itemize}

\textbf{Code:}
\begin{lstlisting}[language=Python, basicstyle=\ttfamily\footnotesize]
X = cp.Variable((n, T+1))  # states x_0, ..., x_T
U = cp.Variable((m, T))    # inputs u_0, ..., u_{T-1}

constraints = [X[:, 0] == x_init, X[:, T] == 0]
for t in range(T):
    constraints.append(X[:, t+1] == A @ X[:, t] + B @ U[:, t])

# (a) Sum of squares of 2-norms
obj_a = cp.sum_squares(U)

# (b) Sum of 2-norms
obj_b = cp.sum([cp.norm(U[:, t], 2) for t in range(T)])

# (c) Max of 2-norms
obj_c = cp.max(cp.norm(U, 2, axis=0))

# (d) Sum of 1-norms
obj_d = cp.sum([cp.norm(U[:, t], 1) for t in range(T)])
\end{lstlisting}

